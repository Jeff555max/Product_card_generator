"""
AI промпты для задач анализа товаров.

Содержит все системные промпты для извлечения и анализа информации о товарах.
"""


class ProductPrompts:
    """Промпты для извлечения и анализа информации о товарах."""
    
    EXTRACT_FROM_TEXT = """Ты - эксперт по анализу товаров. Извлеки информацию о товаре из текста.

КРИТИЧЕСКИ ВАЖНО:
1. Цена: Ищи числа с валютными знаками (₽, руб, $, €) или слова "цена", "стоит", "рублей"
2. Название: Первая строка или явное название товара
3. Описание: Все характеристики и особенности товара

Верни ТОЛЬКО валидный JSON (без markdown, без ```json):
{{
    "name": "полное название товара",
    "price": "точная цена с валютой (например: 5990₽ или 5990 руб.)",
    "description": "подробное описание товара",
    "category": "категория товара",
    "color": "цвет товара или null",
    "size": "размер товара или null",
    "other_features": {{
        "характеристика": "значение"
    }}
}}

Примеры правильного извлечения цены:
- "5990₽" → "5990₽"
- "цена 5990 рублей" → "5990₽"
- "стоит 100$" → "100$"
- "5990 руб" → "5990₽"

Текст для анализа:
{text}

ВАЖНО: Возвращай ТОЛЬКО JSON объект, никакого дополнительного текста!"""

    EXTRACT_FROM_IMAGE = """Ты - эксперт по анализу изображений товаров. Проанализируй фото и извлеки информацию.

КРИТИЧЕСКИ ВАЖНО:
1. Внимательно изучи все видимые детали на изображении
2. Прочитай весь текст на упаковке, этикетках, ценниках
3. Определи тип товара, бренд, модель
4. Оцени примерную цену на основе типа товара и качества

Верни ТОЛЬКО валидный JSON (без markdown, без ```json):
{{
    "name": "точное название товара с брендом",
    "price": "примерная цена с ₽ (если есть ценник на фото - точная цена)",
    "category": "категория товара",
    "color": "основные видимые цвета",
    "size": "размер если виден",
    "description": "подробное описание того, что видно на изображении",
    "other_features": {{
        "характеристика": "значение"
    }}
}}

Примеры:
- Если видишь "5990₽" на ценнике → "5990₽"
- Если это iPhone → примерно "50000-80000₽"
- Если это наушники Sony → примерно "15000-25000₽"

ВАЖНО: Возвращай ТОЛЬКО JSON объект, никакого дополнительного текста!"""

    SUGGEST_IMPROVEMENTS = """Проанализируй описание товара и предложи улучшения.

Предоставь:
1. SEO ключевые слова
2. Важные характеристики для выделения
3. Недостающую информацию
4. Улучшения стиля текста
5. Призыв к действию

Описание товара:
{description}

Формат: пункты списка на русском языке."""

    SUGGEST_TEMPLATE = """На основе следующей информации о товаре предложи лучший стиль шаблона карточки.

Доступные шаблоны:
- 'minimal': Чистый, современный дизайн с большим количеством пространства. Лучше для техники, моды, минималистичных товаров.
- 'dark': Роскошная тёмная тема с яркими акцентами. Лучше для премиум, люкс, игровых, технических товаров.
- 'marketplace': Профессиональный стиль маркетплейса. Лучше для общей розницы, каталогов, мультитоварных магазинов.

Информация о товаре:
{product_info}

Верни ТОЛЬКО валидный JSON объект:
{
    "template_name": "minimal|dark|marketplace",
    "reasoning": "краткое объяснение почему этот шаблон подходит",
    "color_suggestions": ["цвет1", "цвет2"]
}

Важно: Возвращай ТОЛЬКО валидный JSON на русском языке."""

    EXTRACT_TEXT_FROM_IMAGE = """Извлеки весь видимый текст с этого изображения товара.

Включай:
- Названия брендов и логотипы
- Характеристики товара на упаковке
- Цены и рекламный текст
- Любой другой читаемый текст

Формат: Простой текст на русском языке, организованный по разделам если применимо."""


class ConversationPrompts:
    """Промпты для диалоговых взаимодействий с пользователями."""
    
    ASK_MISSING_INFO = """Пользователь предоставил неполную информацию о товаре.

Уже известно:
{known_info}

Отсутствует:
{missing_fields}

Сгенерируй дружелюбное, разговорное сообщение на русском языке, попросив пользователя предоставить недостающую информацию.
Будь краток и естественен."""

    CONFIRM_EXTRACTED_DATA = """Сгенерируй сообщение подтверждения с извлечённой информацией о товаре.

Извлечённые данные:
{data}

Создай хорошо отформатированное сообщение на русском языке, спрашивающее пользователя, верна ли информация.
Используй эмодзи уместно и сделай текст легко читаемым."""


class ErrorPrompts:
    """Промпты для обработки ошибок и восстановления."""
    
    RETRY_ANALYSIS = """Предыдущая попытка анализа не удалась или вернула неверные данные.

Ошибка: {error}

Попробуй извлечь информацию о товаре снова из:
{input_data}

Будь более снисходительным при извлечении данных и предоставляй лучшие предположения, когда информация неоднозначна. Отвечай на русском языке."""
